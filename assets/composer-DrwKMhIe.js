import{V as M,c as E,R as y,C as S,d as P,S as C,a as D,W as x,N as b,P as T,M as g,b as G,G as W,e as N,x as R,H as v}from"./index-CYDsy1T_.js";import{x as I,N as A,E as F,b as H,c as L,d as i,e as k,T as z,f as B,S as O,u as j,P as K,A as V}from"./shared-wQNbZs9z.js";import{i as q,O as U}from"./tiny-invariant-AYIrcFyz.js";import{g as X,a as Z,b as J}from"./celestialDirections-CJAFHZKf.js";let t,e,c,r,d,p,n;const l=new M,m=new M,f=new E,Q=new Date("2000-06-01T09:00:00Z"),Y=new y(0,S(90),1e3),w=Y.toECEF(),_=P.WGS84.getSurfaceNormal(w);function $(){r=new C;const a=window.innerWidth/window.innerHeight;e=new D(75,a,10,1e6),e.position.copy(w),e.up.copy(_);const o=document.getElementById("container");q(o!=null),c=new U(e,o),c.enableDamping=!0,c.minDistance=1e3,c.target.copy(w),t=new x({antialias:!0,depth:!1,logarithmicDepthBuffer:!0}),t.setPixelRatio(window.devicePixelRatio),t.setSize(window.innerWidth,window.innerHeight),t.toneMapping=b,t.toneMappingExposure=10,t.shadowMap.enabled=!0,t.shadowMap.type=T,o.appendChild(t.domElement),d=new I;const h=new g(new G(2,2),d);h.frustumCulled=!1,r.add(h);const s=new W;P.WGS84.getEastNorthUpFrame(w).decompose(s.position,s.quaternion,s.scale);const u=new g(new N(200,60,256,64),new R({color:"white"}));u.castShadow=!0,u.receiveShadow=!0,s.add(u),r.add(s),p=new A(e,{correctGeometricError:!0,correctAltitude:!0,inscatter:!0,photometric:!0,skyIrradiance:!0,sunIrradiance:!0,transmittance:!0,irradianceScale:2/Math.PI,sky:!0,sun:!0,moon:!0}),n=new F(t,{frameBufferType:v,multisampling:8}),n.addPass(new H(r,e)),n.addPass(new L(r,e)),n.addPass(new i(e,p)),n.addPass(new i(e,new k)),n.addPass(new i(e,new z({mode:B.AGX}))),n.addPass(new i(e,new O)),n.addPass(new i(e,new j)),new K().setTypeFromRenderer(t).load("/geospatial/"+"assets/atmosphere",ee),window.addEventListener("resize",te)}function ee(a){Object.assign(d,a),Object.assign(p,a),t.setAnimationLoop(ne)}function te(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight)}function ne(){const a=+Q;X(a,f),Z(a,l).applyMatrix4(f),J(a,m).applyMatrix4(f),d.sunDirection.copy(l),d.moonDirection.copy(m),p.sunDirection.copy(l),p.moonDirection.copy(m),c.update(),n&&(n.passes.forEach(o=>{o.fullscreenMaterial instanceof V&&o.fullscreenMaterial.adoptCameraSettings(e)}),n.render())}window.addEventListener("load",$);
