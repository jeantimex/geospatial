import{V as P,c as S,R as C,C as D,d as E,S as b,a as x,W as T,N as G,P as W,M as g,b as N,G as R,e as v,x as I,H as A}from"./index-CYDsy1T_.js";import{x as F,N as H,E as L,b as M,c as k,d as r,e as z,T as B,f as O,S as j,u as K,P as V,A as q}from"./shared-F2N6z35j.js";import{i as U,O as X}from"./tiny-invariant-AYIrcFyz.js";import{g as Z,a as J,b as Q}from"./celestialDirections-CJAFHZKf.js";let n,e,c,s,d,p,t;const u=new P,m=new P,f=new S,Y=new Date("2000-06-01T09:00:00Z"),_=new C(0,D(90),1e3),w=_.toECEF(),$=E.WGS84.getSurfaceNormal(w);function ee(){s=new b;const a=window.innerWidth/window.innerHeight;e=new x(75,a,10,1e6),e.position.copy(w),e.up.copy($);const o=document.getElementById("container");U(o!=null),c=new X(e,o),c.enableDamping=!0,c.minDistance=1e3,c.target.copy(w),n=new T({antialias:!0,depth:!1,logarithmicDepthBuffer:!0}),n.setPixelRatio(window.devicePixelRatio),n.setSize(window.innerWidth,window.innerHeight),n.toneMapping=G,n.toneMappingExposure=10,n.shadowMap.enabled=!0,n.shadowMap.type=W,o.appendChild(n.domElement),d=new F;const h=new g(new N(2,2),d);h.frustumCulled=!1,s.add(h);const i=new R;E.WGS84.getEastNorthUpFrame(w).decompose(i.position,i.quaternion,i.scale);const l=new g(new v(200,60,256,64),new I({color:"white"}));l.castShadow=!0,l.receiveShadow=!0,i.add(l),s.add(i),p=new H(e,{correctGeometricError:!0,correctAltitude:!0,inscatter:!0,photometric:!0,skyIrradiance:!0,sunIrradiance:!0,transmittance:!0,irradianceScale:2/Math.PI,sky:!0,sun:!0,moon:!0}),t=new L(n,{frameBufferType:A,multisampling:8});const y=new M(s,e);y.enabled=!1,t.addPass(new k(s,e)),t.addPass(new M(s,e)),t.addPass(new r(e,p)),t.addPass(new r(e,new z)),t.addPass(new r(e,new B({mode:O.AGX}))),t.addPass(new r(e,new j)),t.addPass(new r(e,new K)),new V().setTypeFromRenderer(n).load("/geospatial/"+"assets/atmosphere",ne),window.addEventListener("resize",te)}function ne(a){Object.assign(d,a),Object.assign(p,a),n.setAnimationLoop(ae)}function te(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),n.setSize(window.innerWidth,window.innerHeight)}function ae(){const a=+Y;Z(a,f),J(a,u).applyMatrix4(f),Q(a,m).applyMatrix4(f),d.sunDirection.copy(u),d.moonDirection.copy(m),p.sunDirection.copy(u),p.moonDirection.copy(m),c.update(),t&&(t.passes.forEach(o=>{o.fullscreenMaterial instanceof q&&o.fullscreenMaterial.adoptCameraSettings(e)}),t.render())}window.addEventListener("load",ee);
