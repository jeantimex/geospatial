import{S as L,W as S,N as R,P as F,a as H,R as I,C as l,X as W,M as j,b as G,T as k,H as v,c as A,V as T}from"./index-CYDsy1T_.js";import{R as N,L as z,x as B,N as U,P as X,a as q,E as O,b as V,c as J,d as s,e as K,T as Q,f as Y,S as Z,u as _}from"./shared-wQNbZs9z.js";import{G as $}from"./index-BTeDwv9f.js";import{g as ee,a as te,b as ne}from"./celestialDirections-CJAFHZKf.js";function ae(t){const{image:r}=t,{width:w,height:p}=r;if(w!==p)throw new Error("Hald CLUT image must be square.");const u=Math.cbrt(w*p);if(u%1!==0)throw new Error("Hald CLUT image must be cubic.");const{data:m}=N.from(r),o=new z(m,u);return o.name=t.name,o.type=t.type,t.colorSpace=o.colorSpace,o}let P,n,e,i,c,d,a,y;const f=new T,h=new T,g=new A,oe=new Date("2025-01-01T15:00:00+09:00");function ie(){i=new L,n=new S({powerPreference:"high-performance",antialias:!0,stencil:!1,depth:!1,logarithmicDepthBuffer:!0}),n.setPixelRatio(window.devicePixelRatio),n.setSize(window.innerWidth,window.innerHeight),n.toneMapping=R,n.toneMappingExposure=10,n.shadowMap.enabled=!0,n.shadowMap.type=F;const t=document.getElementById("container");t&&t.appendChild(n.domElement);const r=window.innerWidth/window.innerHeight;e=new H(75,r,10,1e6);const w=139.7671,p=35.6812,u=180,m=-10,o=4500,x=new I(l(w),l(p)).toECEF();new W(o,l(u),l(m)).decompose(x,e.position,e.quaternion),e.up.set(0,1,0),e.aspect=r,e.updateProjectionMatrix(),c=new B;const E=new j(new G(2,2),c);E.frustumCulled=!1,i.add(E),P=new $(i,e,n),i.add(P.tiles.group),d=new U(e,{correctGeometricError:!0,correctAltitude:!0,inscatter:!0,photometric:!0,skyIrradiance:!0,sunIrradiance:!0,transmittance:!0,irradianceScale:2/Math.PI,sky:!0,sun:!0,moon:!0});const M="/geospatial/";new X().setTypeFromRenderer(n).load(M+"assets/atmosphere",re);const C=new k,b=M+"assets/clut/Fuji/Fuji 160C 1 -.png";C.load(b,D=>{y=ae(D),new q(y)}),a=new O(n,{frameBufferType:v,multisampling:8}),a.addPass(new V(i,e)),a.addPass(new J(i,e)),a.addPass(new s(e,d)),a.addPass(new s(e,new K)),a.addPass(new s(e,new Q({mode:Y.AGX}))),a.addPass(new s(e,new Z)),a.addPass(new s(e,new _)),window.addEventListener("resize",se)}function re(t){Object.assign(c,t),Object.assign(d,t),n.setAnimationLoop(ce)}function se(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),n.setSize(window.innerWidth,window.innerHeight)}function ce(){const t=oe;ee(t,g),te(t,f).applyMatrix4(g),ne(t,h).applyMatrix4(g),c.sunDirection.copy(f),c.moonDirection.copy(h),d.sunDirection.copy(f),d.moonDirection.copy(h),P.update(),a==null||a.render()}window.addEventListener("load",ie);
