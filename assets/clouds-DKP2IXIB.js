import{R as N,C,h as v,a as R,S as D,G as B,i as G,b as O,l as H,V as k,W as U,N as z,H as V,T as b,B as L,r as j,L as F,d,e as s,f as h,g as E,v as y}from"./index-DDLoJ-mC.js";import{N as q,b as I,O as K,E as A,c as _,d as P,e as X,T as Z,f as J,u as Q,P as Y}from"./shared-eb7iGhRc.js";import{i as $,O as x}from"./tiny-invariant-lTr0-bAc.js";import{q as ee,t as g,n as f}from"./shared-CyFPXmZr.js";let i,n,c,l,o,a,r;const ae=new Date("2000-06-01T10:00:00Z"),ne=new N(0,C(67),500),w=ne.toECEF(),oe=v.WGS84.getSurfaceNormal(w);function se(){const e=document.getElementById("container");$(e!=null);const W=window.innerWidth/window.innerHeight;n=new R(75,W,10,1e6),n.position.copy(w),n.up.copy(oe),c=new x(n,e),c.enableDamping=!0,c.minDistance=1e3,c.target.copy(w),l=new D;const p=new B;v.WGS84.getEastNorthUpFrame(w).decompose(p.position,p.quaternion,p.scale),l.add(p);const u=new G(200,60,256,64);u.computeVertexNormals();const M=new O(u,new H({color:"white"}));p.add(M),o=new q(n),o.sky=!0,o.sunIrradiance=!0,o.skyIrradiance=!0;const S=new I(l,n);o.normalBuffer=S.texture,a=new ee(n),a.coverage=.4,a.localWeatherVelocity.set(.001,0),a.events.addEventListener("change",T=>{T.property!==void 0&&ie(T.property)});const m=new k;K(ae,m),o.sunDirection.copy(m),a.sunDirection.copy(m),i=new U({depth:!1,logarithmicDepthBuffer:!1}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.toneMapping=z,i.toneMappingExposure=10,r=new A(i,{frameBufferType:V,multisampling:0}),r.addPass(new _(l,n)),r.addPass(S),r.addPass(new P(n,a,o)),r.addPass(new P(n,new X,new Z({mode:J.AGX}),new Q));const t="/geospatial/";new Y().load(t+"assets/atmosphere",te),new b().load(t+"assets/clouds/local_weather.png",re),new(L(y,{width:g,height:g,depth:g}))().load(t+"assets/clouds/shape.bin",de),new(L(y,{width:f,height:f,depth:f}))().load(t+"assets/clouds/shape_detail.bin",pe),new b().load(t+"assets/clouds/turbulence.png",ce),new j().load(t+"assets/core/stbn.bin",le),e.appendChild(i.domElement),window.addEventListener("resize",we)}function ie(e){switch(e){case"atmosphereOverlay":o.overlay=a.atmosphereOverlay;break;case"atmosphereShadow":o.shadow=a.atmosphereShadow;break;case"atmosphereShadowLength":o.shadowLength=a.atmosphereShadowLength;break}}function te(e){Object.assign(o,e),Object.assign(a,e),i.setAnimationLoop(he)}function re(e){e.minFilter=F,e.magFilter=d,e.wrapS=s,e.wrapT=s,e.colorSpace=h,e.needsUpdate=!0,a.localWeatherTexture=e}function de(e){e.format=E,e.minFilter=d,e.magFilter=d,e.wrapS=s,e.wrapT=s,e.wrapR=s,e.colorSpace=h,e.needsUpdate=!0,a.shapeTexture=e}function pe(e){e.format=E,e.minFilter=d,e.magFilter=d,e.wrapS=s,e.wrapT=s,e.wrapR=s,e.colorSpace=h,e.needsUpdate=!0,a.shapeDetailTexture=e}function ce(e){e.minFilter=F,e.magFilter=d,e.wrapS=s,e.wrapT=s,e.colorSpace=h,e.needsUpdate=!0,a.turbulenceTexture=e}function le(e){o.stbnTexture=e,a.stbnTexture=e}function we(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)}function he(){c.update(),r.render()}window.addEventListener("load",se);
